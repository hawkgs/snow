!function(){"use strict";const a={width:640,height:480,fps:30,gravity:.08,windMagnitude:.07,dragMagnitude:.1,terminalVelocityRate:5,snowflakeTtl:3e4,snowfallIntensity:4,offScreenOffset:300};class n{constructor(t,i){this.x=t,this.y=i}add(t){t=this.__vectorize(t);return this.x+=t.x,this.y+=t.y,this}divide(t){t=this.__vectorize(t);return this.x/=t.x,this.y/=t.y,this}multiply(t){t=this.__vectorize(t);return this.x*=t.x,this.y*=t.y,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){var t=this.magnitude();return 0!==t&&this.divide(t),this}limit(t,i,e,s){return this.x=Math.min(this.x,i),this.x=Math.max(t,this.x),this.y=Math.min(this.y,s),this.y=Math.max(e,this.y),this}copy(){return new n(this.x,this.y)}__vectorize(t){if(t instanceof n)return t;if("number"==typeof t)return new n(t,t);throw new Error("Vector: Cannot vectorize argument.")}}function i(t,i){return new n(0,t.gravity*i.mass)}function e(t){return new n(t.windMagnitude,0)}function s(t,i){var i=i.velocity,e=i.magnitude(),t=t.dragMagnitude*e*e;return i.multiply(-1),i.normalize(),i.multiply(t)}function h(t,i){var e=.5<Math.random()?1:-1,e=Math.random()*e*(1<i.mass?i.mass/i.mass*2:1);return new n(e,0)}class o{constructor(t,i,e,s,a){this.location=new n(t,i),this.acceleration=new n(0,0),this.velocity=new n(0,0),this.size=e,this.config=a,this.translucency=s,this.mass=this.__calcMass(),this.createdAt=Date.now(),this.atRest=!1}applyForce(t){t.divide(this.mass),this.acceleration.add(t)}update(){var t,i;this.atRest||this.location.y>=this.config.height-this.size?this.atRest=!0:(this.velocity.add(this.acceleration),i=(t=this.config).terminalVelocityRate*this.size,this.velocity.limit(-i,i,-i,i),this.location.add(this.velocity),this.location.limit(-t.offScreenOffset,t.width+t.offScreenOffset,0,t.height-this.size),this.acceleration.multiply(0))}__calcMass(){return this.size*this.size}}class l{constructor(t){this.config=t,this.snowflakes=[],this.forceFactories=[]}applyForceFactory(t){this.forceFactories.push(t)}update(){this.__createSnowflakeLayer();var i=[];for(let t=0;t<this.snowflakes.length;t++){var e=this.snowflakes[t];if(Date.now()-e.createdAt>=this.config.snowflakeTtl)i.push(t);else if(!e.atRest){for(const s of this.forceFactories)e.applyForce(s(this.config,{location:e.location.copy(),velocity:e.velocity.copy(),mass:e.mass}));e.update()}}for(const t of i)this.snowflakes.splice(t,1)}__createSnowflakeLayer(){for(let t=0;t<this.config.snowfallIntensity;t++)this.__createSnowflake()}__createSnowflake(){var t=this.config,t=r(-t.offScreenOffset,t.width+t.offScreenOffset),i=r(-500,-200),e=r(1,10)/10,s=r(1,5);this.snowflakes.push(new o(t,i,s,e,this.config))}}function r(t,i){return Math.round(Math.random()*(i-t)+t)}function c(t,n){const o=new l(t),r=(o.applyForceFactory(i),o.applyForceFactory(s),o.applyForceFactory(e),o.applyForceFactory(h),n.getContext("2d"));function c(t,i,e){requestAnimationFrame(()=>c(t,i,e));var s=Date.now();if(t<(e=s-i)){i=s-e%t,r.clearRect(0,0,n.width,n.height),o.update();for(const a of o.snowflakes)r.beginPath(),r.arc(a.location.x,a.location.y,a.size/2,0,2*Math.PI,!1),r.fillStyle=`rgba(255, 255, 255, ${a.translucency})`,r.fill()}}c(1e3/t.fps,Date.now(),0)}window.Snow={attachToElement:function(t,i){var e,i={...a,...i},s=(s=i,(e=document.createElement("canvas")).className="snow-canvas",e.width=s.width,e.height=s.height,e.style.position="absolute",e.style.top="0",e.style.left="0",e);t.appendChild(s),c(i,s)}}}();